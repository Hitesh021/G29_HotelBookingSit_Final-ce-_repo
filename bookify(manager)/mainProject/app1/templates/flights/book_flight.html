{% extends 'base.html' %}

{% block content %}
<div class="container-xxl py-5">
    <div class="container">
        <div class="text-center wow fadeInUp" data-wow-delay="0.1s">
            <h6 class="section-title text-center text-primary text-uppercase">Book Flight</h6>
            <h1 class="mb-5">Passenger <span class="text-primary text-uppercase">Information</span></h1>
        </div>
        
        {% if error %}
        <div class="row mb-5">
            <div class="col-lg-12">
                <div class="alert alert-danger" role="alert">
                    {{ error }}
                </div>
            </div>
        </div>
        {% endif %}
        
        <div class="row g-5">
            <div class="col-lg-8 wow fadeInUp" data-wow-delay="0.1s">
                <div class="card shadow">
                    <div class="card-header bg-primary text-white">
                        <h5 class="mb-0">Enter Passenger Details</h5>
                    </div>
                    <div class="card-body">
                        <form action="{% url 'book_flight' offer_id %}" method="post" class="needs-validation" novalidate>
                            {% csrf_token %}
                            
                            <!-- Passenger Information Section -->
                            <h5 class="mb-4">Passenger 1 (Primary Contact)</h5>
                            <div class="row g-3">
                                <div class="col-md-6">
                                    <div class="form-floating">
                                        <input type="text" class="form-control" id="firstName" name="firstName" placeholder="First Name" required>
                                        <label for="firstName">First Name</label>
                                        <div class="invalid-feedback">
                                            Please enter your first name.
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-floating">
                                        <input type="text" class="form-control" id="lastName" name="lastName" placeholder="Last Name" required>
                                        <label for="lastName">Last Name</label>
                                        <div class="invalid-feedback">
                                            Please enter your last name.
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-floating">
                                        <input type="date" class="form-control" id="dob" name="dob" placeholder="Date of Birth" required>
                                        <label for="dob">Date of Birth</label>
                                        <div class="invalid-feedback">
                                            Please enter your date of birth.
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-floating">
                                        <select class="form-select" id="gender" name="gender" required>
                                            <option value="">Select Gender</option>
                                            <option value="M">Male</option>
                                            <option value="F">Female</option>
                                            <option value="O">Other</option>
                                        </select>
                                        <label for="gender">Gender</label>
                                        <div class="invalid-feedback">
                                            Please select your gender.
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-floating">
                                        <input type="email" class="form-control" id="email" name="email" placeholder="Email" required>
                                        <label for="email">Email</label>
                                        <div class="invalid-feedback">
                                            Please enter a valid email address.
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-floating">
                                        <input type="tel" class="form-control" id="phone" name="phone" placeholder="Phone" required>
                                        <label for="phone">Phone</label>
                                        <div class="invalid-feedback">
                                            Please enter your phone number.
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Passport Information (for international flights) -->
                            <h5 class="mt-5 mb-4">Passport Information (for international flights)</h5>
                            <div class="row g-3">
                                <div class="col-md-6">
                                    <div class="form-floating">
                                        <input type="text" class="form-control" id="passportNumber" name="passportNumber" placeholder="Passport Number">
                                        <label for="passportNumber">Passport Number</label>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-floating">
                                        <select class="form-select" id="nationality" name="nationality">
                                            <option value="">Select Nationality</option>
                                            <option value="US">United States</option>
                                            <option value="GB">United Kingdom</option>
                                            <option value="CA">Canada</option>
                                            <option value="AU">Australia</option>
                                            <!-- Add more countries as needed -->
                                        </select>
                                        <label for="nationality">Nationality</label>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-floating">
                                        <input type="date" class="form-control" id="passportExpiry" name="passportExpiry" placeholder="Passport Expiry Date">
                                        <label for="passportExpiry">Passport Expiry Date</label>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Special Requests -->
                            <h5 class="mt-5 mb-4">Special Requests</h5>
                            <div class="row g-3">
                                <div class="col-12">
                                    <div class="form-floating">
                                        <textarea class="form-control" id="specialRequests" name="specialRequests" placeholder="Special Requests" style="height: 100px"></textarea>
                                        <label for="specialRequests">Special Requests (meal preferences, assistance, etc.)</label>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Payment Information would typically be handled by a secure payment processor -->
                            
                            <div class="mt-5">
                                <button type="submit" class="btn btn-primary py-3 px-5">Continue to Payment</button>
                                <a href="{% url 'flight_detail' offer_id %}" class="btn btn-outline-secondary py-3 px-5 ms-2">Back to Flight Details</a>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
            
            <div class="col-lg-4 wow fadeInUp" data-wow-delay="0.3s">
                <div class="card shadow">
                    <div class="card-header bg-primary text-white">
                        <h5 class="mb-0">Flight Summary</h5>
                    </div>
                    <div class="card-body">
                        <!-- Flight Summary Information -->
                        <div class="mb-4">
                            <h6 class="mb-3">New York (JFK) to Los Angeles (LAX)</h6>
                            <div class="d-flex justify-content-between mb-2">
                                <span>Departure:</span>
                                <strong>Apr 20, 2023, 08:00 AM</strong>
                            </div>
                            <div class="d-flex justify-content-between mb-2">
                                <span>Arrival:</span>
                                <strong>Apr 20, 2023, 05:30 PM</strong>
                            </div>
                            <div class="d-flex justify-content-between mb-2">
                                <span>Flight:</span>
                                <strong>AA123, AA456</strong>
                            </div>
                            <div class="d-flex justify-content-between mb-2">
                                <span>Passengers:</span>
                                <strong>1 Adult</strong>
                            </div>
                        </div>
                        
                        <hr>
                        
                        <!-- Price Summary -->
                        <h6 class="mb-3">Price Summary</h6>
                        <div class="d-flex justify-content-between mb-2">
                            <span>Base Fare:</span>
                            <strong>$350.00</strong>
                        </div>
                        <div class="d-flex justify-content-between mb-2">
                            <span>Taxes & Fees:</span>
                            <strong>$76.50</strong>
                        </div>
                        <hr>
                        <div class="d-flex justify-content-between mb-2">
                            <span>Total Price:</span>
                            <strong class="text-primary">$426.50</strong>
                        </div>
                        
                        <!-- Cancellation Policy -->
                        <div class="mt-4">
                            <h6 class="mb-2">Cancellation Policy</h6>
                            <p class="small text-muted">Cancellation before 48 hours of departure: $50 fee. No refund within 48 hours of departure.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    // Form validation
    (function() {
        'use strict';
        window.addEventListener('load', function() {
            var forms = document.getElementsByClassName('needs-validation');
            var validation = Array.prototype.filter.call(forms, function(form) {
                form.addEventListener('submit', function(event) {
                    if (form.checkValidity() === false) {
                        event.preventDefault();
                        event.stopPropagation();
                    }
                    form.classList.add('was-validated');
                }, false);
            });
        }, false);
    })();
</script>
{% endblock %} 